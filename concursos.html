<!DOCTYPE html>
<html lang="pt-BR" data-theme="light">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ponto Zero | Concursos</title>
  <link rel="stylesheet" href="css/style.css" />
</head>

<body>
  <header class="nav">
    <div class="container navbar">
      <a class="brand" href="home.html"><span class="name">Ponto Zero</span><span class="tag">orientação</span></a>

      <nav class="navlinks">
        <a href="emprego.html">Emprego</a>
        <a href="cursos.html">Cursos</a>
        <a href="concursos.html">Concursos</a>
      </nav>

      <div class="navright">
        <div class="searchwrap" role="search">
          <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M10.8 18.2a7.4 7.4 0 1 1 0-14.8 7.4 7.4 0 0 1 0 14.8Z" stroke="rgba(26,19,36,.70)" stroke-width="2"/>
            <path d="M16.9 16.9 21 21" stroke="rgba(26,19,36,.70)" stroke-width="2" stroke-linecap="round"/>
          </svg>
          <input id="pzSearch" class="search" type="search" placeholder="Pesquisar…" aria-label="Pesquisar" />
          <div id="pzSearchResults" aria-label="Resultados"></div>
        </div>
        <a class="btn" href="index.html">Início</a>
      </div>
    </div>
  </header>

  <main>
    <div class="container">

      <section class="pz-heroSimple">
        <div class="pz-kicker">
          <span class="pz-kdot"></span>
          concursos públicos
        </div>

        <h1 class="pz-heroTitle2">Concurso, com clareza</h1>

        <p class="pz-heroSub2">
          Aqui você começa pelo básico: fontes confiáveis, nível (médio/técnico/superior) e um plano mínimo.
          Sem ficar pulando de link em link.
        </p>

        <div class="pz-heroLinks">
          <a class="pz-textLink" href="#fontes">ver fontes</a>
          <a class="pz-textLink" href="#passos">passos iniciais</a>
        </div>
      </section>

      <section class="pz-layout">
        <!-- ESQUERDA -->
        <div>
          <section class="section" id="fontes">
            <div class="sectionTop">
              <h2>fontes</h2>
              <p>Filtre por tipo e abra só o que faz sentido pra você hoje.</p>
            </div>

            <div class="pz-chipRow" aria-label="Filtros">
              <button class="pz-chip" type="button" aria-pressed="true" data-filter="all">Tudo</button>
              <button class="pz-chip" type="button" aria-pressed="false" data-filter="portal">Portal</button>
              <button class="pz-chip" type="button" aria-pressed="false" data-filter="médio">Médio</button>
              <button class="pz-chip" type="button" aria-pressed="false" data-filter="técnico">Técnico</button>
              <button class="pz-chip" type="button" aria-pressed="false" data-filter="superior">Superior</button>
            </div>

            <div id="list" class="pz-platformGrid"></div>
            <div id="empty" class="cardSoft" style="display:none;">Nenhuma fonte encontrada.</div>
          </section>
        </div>

        <!-- DIREITA -->
        <aside class="pz-side2" id="passos">
          <div class="pz-sideCard2">
            <div class="pz-sideHead">
              <div>
                <div class="pz-sideTitle2">Passos iniciais</div>
                <div class="pz-sideSub2">Sem caos, sem pressa.</div>
              </div>
              <div class="pz-badge">guia</div>
            </div>

            <div class="pz-steps">
              <div class="pz-step">
                <div class="pz-stepN">1</div>
                <div class="pz-stepT">
                  <strong>Escolha 1 alvo</strong>
                  <small>Nível médio é o mais comum pra começar.</small>
                </div>
              </div>
              <div class="pz-step">
                <div class="pz-stepN">2</div>
                <div class="pz-stepT">
                  <strong>Baixe o edital</strong>
                  <small>Requisitos + matérias + datas.</small>
                </div>
              </div>
              <div class="pz-step">
                <div class="pz-stepN">3</div>
                <div class="pz-stepT">
                  <strong>Plano mínimo</strong>
                  <small>Português + matemática + informática (e o edital).</small>
                </div>
              </div>
            </div>

            <div class="pz-miniAlerts">
              <div class="pz-miniAlert warn">
                <div class="pz-miniK">Cuidado</div>
                <div class="pz-miniV">Inscrição só em portal oficial ou banca indicada no edital.</div>
              </div>
            </div>

            <div class="pz-sideLinks">
              <a class="pz-textLink" href="quiz.html">refazer quiz</a>
              <a class="pz-textLink" href="#" id="openSupportHint">falar no suporte</a>
            </div>
          </div>

          <div class="pz-sideCard2">
            <div class="pz-sideHead">
              <div>
                <div class="pz-sideTitle2">Glossário rápido</div>
                <div class="pz-sideSub2">Pra não travar lendo edital.</div>
              </div>
              <div class="pz-badge ghost">extra</div>
            </div>

            <div class="pz-cvCard">
              <div class="pz-cvRow">
                <div class="pz-cvK">Banca</div>
                <div class="pz-cvV">Quem organiza prova/inscrição/correção.</div>
              </div>
              <div class="pz-cvRow">
                <div class="pz-cvK">PSS</div>
                <div class="pz-cvV">Seleção simplificada (muitas vezes temporária).</div>
              </div>
              <div class="pz-cvRow">
                <div class="pz-cvK">Cadastro reserva</div>
                <div class="pz-cvV">Você pode ser chamado depois, dentro da validade.</div>
              </div>
            </div>
          </div>
        </aside>
      </section>

      <footer>Ponto Zero • protótipo</footer>
    </div>
  </main>

  <script type="module">
    import { boot } from "./js/main.js";
    import { listConcursos } from "./js/db.js";

    boot();

    const list = document.getElementById("list");
    const empty = document.getElementById("empty");
    const chips = Array.from(document.querySelectorAll("[data-filter]"));

    let allItems = [];
    let current = "all";

    function pill(label){ return `<span class="pz-pill">${label}</span>`; }

    function norm(s){ return (s||"").toLowerCase().trim(); }

    function renderItem(it){
      const nivel = it.nivel ? it.nivel : "Portal";
      const tags = [nivel, it.regiao || "Sergipe", "Fonte"].slice(0,3).map(pill).join("");

      return `
        <article class="pz-platform" data-nivel="${norm(nivel)}">
          <div class="pz-platformHead">
            <div class="pz-platformTitle">${it.nome}</div>
            <div class="pz-platformMeta">${tags}</div>
          </div>

          <p class="pz-platformDesc">Fonte para consultar editais, inscrições e atualizações com segurança.</p>

          <div class="pz-platformActions">
            <a class="pz-textLink" href="${it.link}" target="_blank" rel="noopener">abrir site</a>
            <button class="pz-textLink ghost" type="button" data-copy="${it.link}">copiar link</button>
            <button class="pz-textLink ghost" type="button" data-more>ver detalhes</button>
          </div>

          <div class="pz-courseMore">
            <div class="pz-metaGrid">
              <div class="pz-metaBox">
                <div class="pz-metaK">O que olhar primeiro</div>
                <div class="pz-metaV">Edital (PDF), datas, requisitos.</div>
              </div>
              <div class="pz-metaBox">
                <div class="pz-metaK">Como confirmar</div>
                <div class="pz-metaV">Banca indicada no edital + portal oficial.</div>
              </div>
            </div>
          </div>
        </article>
      `;
    }

    function applyFilter(){
      if (!allItems.length) return;

      const html = allItems
        .filter(it => {
          if (current === "all") return true;
          const nivel = norm(it.nivel || "portal");
          if (current === "portal") return nivel.includes("portal");
          return nivel.includes(current);
        })
        .map(renderItem).join("");

      list.innerHTML = html || "";
      empty.style.display = html ? "none" : "block";
    }

    chips.forEach(btn => {
      btn.addEventListener("click", () => {
        chips.forEach(b => b.setAttribute("aria-pressed","false"));
        btn.setAttribute("aria-pressed","true");
        current = btn.getAttribute("data-filter");
        applyFilter();
      });
    });

    list.addEventListener("click", async (e) => {
      const copy = e.target.closest("button[data-copy]");
      const more = e.target.closest("button[data-more]");
      if (copy) {
        try { await navigator.clipboard.writeText(copy.getAttribute("data-copy")); copy.textContent = "copiado"; }
        catch { copy.textContent = "não copiou"; }
      }
      if (more) {
        const card = e.target.closest(".pz-platform");
        const details = card.querySelector(".pz-courseMore");
        details.classList.toggle("show");
        more.textContent = details.classList.contains("show") ? "fechar detalhes" : "ver detalhes";
      }
    });

    try {
      allItems = await listConcursos({ regiao: "Sergipe" });
      if (!allItems.length) empty.style.display = "block";
      applyFilter();
    } catch (e) {
      empty.style.display = "block";
      empty.textContent = "Erro ao carregar: " + (e.message || e);
    }

    document.getElementById("openSupportHint")?.addEventListener("click", (ev) => {
      ev.preventDefault();
      const fab = document.querySelector(".chatFab");
      if (fab) fab.click();
    });
  </script>
</body>
</html>
